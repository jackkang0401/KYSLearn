# 链接器

### 1.概述

* Mach-O 文件里面的内容，主要就是代码和数据。代码是函数的定义，数据是全局变量的定义，包括全局变量的初始值。不管是代码还是数据，它们的实例都需要由符号将其关联起来。
* 为什么呢？因为 Mach-O 文件里的那些代码，比如 if、for、while 生成的机器指令序列，要操作的数据会存储在某个地方，变量符号就需要绑定到数据的存储地址。你写的代码还会引用其他的代码，引用的函数符号也需要绑定到该函数的地址上
* 作用：将符号绑定到地址上（变量、函数符号和其地址绑定）


### 2.编译器 & 解释器

* 先使用编译器把代码编译成机器码，然后直接在 CPU 上执行，采用编译器生成机器码执行的好处是效率高，缺点是调试周期长
* 解释器运行时去执行代码具有动态性，好处是编写调试方便，缺点是执行效率低


### 3.LLVM（编译器）

> LLVM 是编译器工具链技术的一个集合。而其中的 lld 项目，就是内置链接器。编译器会对每个文件进行编译，生成 Mach-O（可执行文件）；链接器会将项目中的多个 Mach-O 文件合并成一个

* 首先，你写好代码后，LLVM 会预处理你的代码，比如把宏嵌入到对应的位置
* 预处理完后，LLVM 会对代码进行词法分析和语法分析，生成 AST 。AST 是抽象语法树，结构上比代码更精简，遍历起来更快，所以使用 AST 能够更快速地进行静态检查，同时还能更快地生成 IR（中间表示）
* 最后 AST 会生成 IR，IR 是一种更接近机器码的语言，区别在于和平台无关，通过 IR 可以生成多份适合不同平台的机器码。对于 iOS 系统，IR 生成的可执行文件就是 Mach-O
